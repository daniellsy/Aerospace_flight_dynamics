clear;
clc;
[t1,y1]=ode45(@first_stage,[0,10],[pi/2,0,0,0]);
[t2,y2]=ode45(@second_stage,[10,150],[pi/2,156.5733,4.7464e-14,775.1517]);
plot(y1(:,3),y1(:,4),'k','LineWidth',1.5);
hold on;
plot(y2(:,3),y2(:,4),'k','LineWidth',1.5);
xlabel('x/m');ylabel('y/m');title('纵向运动轨迹x-y图');
figure(2);
plot(t1,y1(:,2),'LineWidth',1.2);hold on;plot(t2,y2(:,2),'LineWidth',1.2);
xlabel('t/s');ylabel('V/(m/s)');title('V-t图');
figure(3);
plot(t1,y1(:,1),'LineWidth',1.2);hold on;plot(t2,y2(:,1),'LineWidth',1.2);
xlabel('t/s');ylabel('theta/rad');title('theta-t图');
angle1=zeros(1,69);angle2=35*(faipr(t2)-y2(:,1));
figure(4);
plot(t1,angle1,'LineWidth',1.2);hold on;plot(t2,angle2,'LineWidth',1.2);
xlabel('t/s');ylabel('alpha/rad');title('alpha-t图');
t=[0:0.01:150];
V0=0;
Vr=7000;
m0=8000;
m=m0-28.57*t;
Vt=-Vr*log(m/m0)+V0;
figure(5);
plot(t1,y1(:,2),'k','LineWidth',1.2);hold on;plot(t2,y2(:,2),'k','LineWidth',1.2);
hold on;
plot(t,Vt,'r','LineWidth',1.2);
xlabel('t/s');ylabel('V/(m/s)');title('验证齐奥尔科夫斯基公式');
